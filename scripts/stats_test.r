#! /usr/bin/env Rscript

print_test <- function(test_name, v)
{
    cat("TEST_CASE(\"", test_name,"\")\n", sep="")
    cat("{\n")
    
    cat("    std::initializer_list<double> init{", paste(v, collapse = ", "), "};\n", sep="")
    cat("    std::vector<double> v{init};\n", sep="")
    cat("    StatTestResults r(v);\n\n", sep="");
    
    cat("    CHECK(r.sum_ == Approx(", sum(v), "));\n", sep="")
    cat("    CHECK(r.mean_ == Approx(", mean(v), "));\n", sep="")
    cat("    CHECK(r.median_ == Approx(", median(v), "));\n", sep="")
    cat("    CHECK(r.median_of_sorted_ == Approx(", median(v), "));\n", sep="")
    cat("    CHECK(r.median_destructive_ == Approx(", median(v), "));\n", sep="")
    cat("    CHECK(r.percentile30_ == Approx(", quantile(v, .3), "));\n", sep="")
    cat("    CHECK(r.percentile60_ == Approx(", quantile(v, .6), "));\n", sep="")
    cat("    CHECK(r.percentile90_ == Approx(", quantile(v, .9), "));\n", sep="")
    cat("    CHECK(r.percentile99_ == Approx(", quantile(v, .99), "));\n", sep="")
    cat("    CHECK(r.variance_ == Approx(", var(v), "));\n", sep="")
    cat("    CHECK(r.std_dev_ == Approx(", sd(v), "));\n", sep="")
    cat("    CHECK(r.median_abs_dev_ == Approx(", mad(v), "));\n", sep="")
    cat("    CHECK(r.quartiles_.q1() == Approx(", quantile(v)[2], "));\n", sep="")
    cat("    CHECK(r.quartiles_.q2() == Approx(", quantile(v)[3], "));\n", sep="")
    cat("    CHECK(r.quartiles_.q3() == Approx(", quantile(v)[4], "));\n", sep="")
    cat("    CHECK(r.quartiles_.iqr() == Approx(", IQR(v), "));\n", sep="")
    
    cat("}\n", sep="")
}

#dput(rbinom(5, 100, .8))
print_test("Stat functions binomial 5", 
c(86L, 74L, 79L, 79L, 81L))

#dput(rbinom(25, 1000, .5))
print_test("Stat functions binomial 25", 
c(512L, 492L, 482L, 473L, 516L, 491L, 501L, 516L, 480L, 494L, 
463L, 513L, 508L, 527L, 520L, 544L, 500L, 512L, 515L, 502L, 489L, 
485L, 497L, 498L, 526L))

#dput(rbinom(50, 10000, .7))
print_test("Stat functions binomial 50", 
c(6959L, 7039L, 6967L, 6996L, 7001L, 6994L, 7041L, 6997L, 6932L, 
7032L, 6996L, 7009L, 7047L, 7081L, 6946L, 6977L, 6999L, 7027L, 
7015L, 6925L, 7064L, 6995L, 7048L, 7060L, 7022L, 6974L, 7055L, 
7002L, 6998L, 6991L, 7068L, 6953L, 6979L, 7035L, 6956L, 7142L, 
7073L, 7045L, 7008L, 6954L, 6949L, 7019L, 6896L, 7009L, 7058L, 
7009L, 7041L, 6973L, 7025L, 6972L))

#dput(rchisq(5, 100))
print_test("Stat functions chi 5", 
c(98.8619818916057, 123.034270956706, 100.82069227891, 91.3758878553293, 
98.8000610862524))

#dput(rchisq(25, 1000))
print_test("Stat functions chi 25",
c(1012.1311687505, 1039.39088678792, 1028.55865328976, 1146.0835062116, 
997.129885803622, 1015.32084246004, 1137.48194701911, 1043.46765104444, 
1004.73208539742, 945.733778147831, 971.815571673066, 979.509792408638, 
1034.05529571818, 911.870875717547, 1018.67288846904, 934.833977113064, 
959.648601738989, 1023.88120050981, 1017.78325549675, 1043.25364935584, 
1017.80811397815, 966.674944705043, 993.994577006199, 1025.19386088844, 
1039.1069651742))

#dput(rchisq(50, 260.45))
print_test("Stat functions chi 50",
c(244.742665181292, 260.637937941892, 255.975630652586, 255.481703090723, 
259.483683636706, 243.391929822081, 245.618851480243, 228.740867931612, 
244.784739558957, 294.594743169454, 273.028467574704, 268.115225221155, 
225.514826666697, 285.675624305521, 267.025845275087, 265.075595048677, 
281.53043067992, 288.71953225487, 234.272598496239, 296.222919539829, 
304.894160866272, 259.506414987366, 228.111367006509, 225.233133612603, 
299.980201567854, 225.79120592849, 258.31313551062, 223.508368728143, 
257.988858111342, 273.001553559297, 263.757842777612, 264.067799013243, 
269.592848065127, 244.281224376741, 239.997692420743, 222.323995031648, 
238.686390928615, 282.511610983329, 287.886364841339, 230.525558615198, 
263.063888477299, 227.452837551436, 251.868662262483, 229.46395541115, 
244.876821789991, 285.165579773281, 247.916642768955, 247.042663595815, 
243.349405930054, 273.827975748446))

#dput(rexp(5))
print_test("Stat functions exponential 5", 
c(0.0539191847156349, 0.912105008917761, 2.43184782365773, 0.255417859647423, 
0.404768015723675))

#dput(rexp(25, 20))
print_test("Stat functions exponential 25",
c(0.053254018628732, 0.0322400220436975, 0.0180287017508615, 
0.0283212491543964, 0.0567019662513942, 0.0608384393600232, 0.0430174807531244, 
0.0388306312242007, 0.010773335481648, 0.0205512379296124, 0.0351441272047764, 
0.0118977791396901, 0.0111340129282326, 0.00167028970524689, 
0.0195984495105222, 0.0203838338144124, 0.00769382137388073, 
0.04518164479895, 0.0665928359122431, 0.0331669436767697, 0.0117223523158496, 
0.0499767655560617, 0.0705080034169269, 0.0592306304236359, 0.0260788558749482
))

#dput(rexp(50, 50))
print_test("Stat functions exponential 50",
c(0.0502090178764122, 0.0367384520156269, 0.0498756814078198, 
0.0107328163459897, 0.00443620080128312, 0.0386657296104317, 
0.0140675874351167, 0.0565276712662453, 0.0317720670024639, 0.025006961262876, 
0.0014044329430908, 0.0126398038677871, 0.0456272490942832, 0.0171855383544209, 
0.0323059025305391, 0.00474217222058435, 0.00637522248671457, 
0.00383542207065263, 0.0173884900837185, 0.013012830298394, 0.048493820687098, 
0.00333154315550036, 0.0206112099640576, 0.00155323576182127, 
0.00662546487525105, 0.0110410280711949, 0.0106375683564693, 
0.0260436311728301, 0.0211963710925522, 0.0107479507382959, 0.00233477246016264, 
0.0130428046453744, 0.0142191978109977, 0.00630036268383265, 
0.186573094826445, 0.00120075540183194, 0.00029676147736609, 
0.0581410907175312, 0.0197498688838425, 0.0078161546587944, 0.0137457921355963, 
0.0124571002449853, 0.0208827884206719, 0.00163977955803892, 
0.0061718842779894, 0.0867292795279875, 0.00392397687770426, 
0.0206359926789048, 0.00384071293286979, 0.00418382271192968))

#dput(rnorm(5))
print_test("Stat functions normal 5", 
c(-0.559125181768341, 0.651534777988678, -0.639924790091285, 
-0.78943223108541, -0.650139760186002))

#dput(rnorm(25, 1000, 10))
print_test("Stat functions normal 25", 
c(990.720960957983, 1010.30222979975, 995.555277105668, 992.088301034307, 
990.790599620314, 1008.96196847324, 1009.22777996769, 1003.25385729438, 
990.807291964739, 1027.81975939755, 1003.85102769909, 1009.48742800353, 
993.492074205499, 1008.05613351092, 1007.60983307623, 1003.81213154894, 
1013.12640512888, 1006.3502316437, 994.732511472554, 1003.32729727116, 
992.852672923776, 1019.37438066321, 1006.48444474692, 1001.70859209366, 
989.68050469443))

#dput(rnorm(50, 500, .5))
print_test("Stat functions normal 50", 
c(500.176088007035, 500.228043812204, 500.396494945291, 499.492185134377, 
500.210878808366, 499.944525464039, 499.931137112798, 500.6319678458, 
499.192291507491, 499.8775092037, 500.470451707533, 499.220567323169, 
500.609383034243, 500.460496706627, 500.597365223696, 500.752019306853, 
500.37497641798, 500.480053668647, 499.567842155837, 499.085713643426, 
500.049949894031, 499.755132535133, 500.063949078524, 499.887706929493, 
500.128690629207, 499.734534753875, 500.133457042526, 499.84325529444, 
499.501749450401, 499.772007177791, 500.256541642208, 499.057698864551, 
499.719653786406, 500.37318525625, 499.62915614049, 499.991696091003, 
499.918716543758, 500.012345629597, 500.901043281073, 499.161017757423, 
499.556504818652, 500.678120730881, 500.33983045193, 499.855925484268, 
500.657627754702, 499.619853144237, 500.075609829268, 500.332631945989, 
499.860148106686, 499.886377961932))

#dput(rpois(5, 10))
print_test("Stat functions poisson 5",
c(12L, 11L, 8L, 9L, 8L))

#dput(rpois(25, 100))
print_test("Stat functions poisson 25",
c(113L, 95L, 102L, 110L, 110L, 112L, 100L, 104L, 101L, 98L, 118L, 
108L, 112L, 101L, 105L, 111L, 112L, 85L, 109L, 90L, 95L, 110L, 
94L, 95L, 106L))


#dput(rpois(50, 100))
print_test("Stat functions poisson 50",
c(104L, 97L, 99L, 86L, 87L, 110L, 102L, 96L, 107L, 119L, 108L, 
82L, 100L, 83L, 102L, 96L, 103L, 101L, 90L, 98L, 112L, 100L, 
90L, 104L, 101L, 109L, 91L, 101L, 106L, 97L, 93L, 99L, 88L, 107L, 
96L, 127L, 89L, 81L, 110L, 100L, 93L, 115L, 99L, 95L, 99L, 84L, 
121L, 102L, 82L, 98L))

#dput(runif(5, .8, .9))
print_test("Stat functions uniform 5",
c(0.848685432551429, 0.818901048926637, 0.802276718313806, 0.822603191551752, 
0.873941182531417))

#dput(runif(25, 5.67, 5.98))
print_test("Stat functions uniform 25",
c(5.87723230002914, 5.6846585479402, 5.89022450711345, 5.83130883357022, 
5.83619991771877, 5.72601183444494, 5.68820755925961, 5.8528499130276, 
5.69887897853041, 5.77280530784046, 5.69265066596214, 5.7186302333395, 
5.80333107203245, 5.71937502638903, 5.94235895415768, 5.76360722513171, 
5.97911122135585, 5.74486273665912, 5.79828442061553, 5.6748301498103, 
5.83155388433719, 5.72220995835029, 5.88001430155942, 5.74535845764447, 
5.89278154956643))

#dput(runif(50, .00023, .0024))
print_test("Stat functions uniform 50",
c(0.00135945691782981, 0.00221295096093323, 0.00202564557293896, 
0.00121713364976691, 0.00201010353010846, 0.0013792662877962, 
0.000939159886662383, 0.00236324996380834, 0.000591637047498953, 
0.00129971312938724, 0.00123513854666147, 0.000253688028701581, 
0.00106666135023115, 0.00192154758600285, 0.000752839108677581, 
0.000767685990883037, 0.00121620384492679, 0.000297368703579996, 
0.00194635223497869, 0.000972309603220783, 0.00142038010848453, 
0.00120435642625205, 0.000593827826962806, 0.00101745254335459, 
0.00201298600221286, 0.00124506608426804, 0.000606940995308105, 
0.000319580983619671, 0.00127760691389441, 0.00124824991129106, 
0.00226709706114838, 0.00217071269629057, 0.000654444400598295, 
0.0013884466692619, 0.000295986357077491, 0.00100736540267477, 
0.00159235588235082, 0.000911758342788089, 0.00183249850905267, 
0.00165701069303788, 0.000812399842205923, 0.00189844515204895, 
0.00218796041656984, 0.00102219639651943, 0.00218211205177242, 
0.00168653694480425, 0.00102559755309718, 0.000901266633726191, 
0.00151460901992861, 0.000968090076572262))

